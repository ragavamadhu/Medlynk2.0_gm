webpackJsonp([8],{UH1D:function(l,n,e){"use strict";function t(l){return c._41(0,[(l()(),c._20(0,null,null,3,"div",[["class","agm-info-window-content"]],null,null,null,null,null)),(l()(),c._40(null,["\n      "])),c._33(null,0),(l()(),c._40(null,["\n    "])),(l()(),c._40(null,["\n  "]))],null,null)}function o(l){return c._41(0,[(l()(),c._20(0,null,null,1,"agm-info-window",[],null,null,null,t,b)),c._18(770048,null,0,h.a,[f.a,c.o],null,null)],function(l,n){l(n,1,0)},null)}function u(l){return c._41(0,[(l()(),c._20(0,null,null,3,"option",[],null,null,null,null,null)),c._18(147456,null,0,m.o,[c.o,c.Q,[2,m.r]],{value:[0,"value"]},null),c._18(147456,null,0,m.w,[c.o,c.Q,[8,null]],{value:[0,"value"]},null),(l()(),c._40(null,[" \n                        ","\n                "]))],function(l,n){l(n,1,0,n.context.$implicit.label),l(n,2,0,n.context.$implicit.label)},function(l,n){l(n,3,0,n.context.$implicit.label)})}function a(l){return c._41(0,[(l()(),c._20(0,null,null,3,"option",[],null,null,null,null,null)),c._18(147456,null,0,m.o,[c.o,c.Q,[2,m.r]],{value:[0,"value"]},null),c._18(147456,null,0,m.w,[c.o,c.Q,[8,null]],{value:[0,"value"]},null),(l()(),c._40(null,[" \n                        ","\n                "]))],function(l,n){l(n,1,0,n.context.$implicit),l(n,2,0,n.context.$implicit)},function(l,n){l(n,3,0,n.context.$implicit)})}function i(l){return c._41(0,[(l()(),c._20(0,null,null,9,"agm-marker",[],null,[[null,"markerClick"],[null,"mouseOver"],[null,"mouseOut"]],function(l,n,e){var t=!0,o=l.component;if("markerClick"===n){t=!1!==o.clickedMarker(l.context.$implicit,l.context.index)&&t}if("mouseOver"===n){t=!1!==o.mouseOver(c._34(l,5),l.context.$implicit)&&t}if("mouseOut"===n){t=!1!==o.mouseOut(c._34(l,5),l.context.$implicit)&&t}return t},null,null)),c._18(1720320,null,1,_.a,[p.a],{latitude:[0,"latitude"],longitude:[1,"longitude"],iconUrl:[2,"iconUrl"]},{markerClick:"markerClick",mouseOver:"mouseOver",mouseOut:"mouseOut"}),c._38(603979776,1,{infoWindow:1}),(l()(),c._40(null,["           \n                  "])),(l()(),c._20(0,null,null,4,"agm-info-window",[],null,null,null,t,b)),c._18(770048,[[1,4],["infoWindow",4]],0,h.a,[f.a,c.o],{latitude:[0,"latitude"],longitude:[1,"longitude"],isOpen:[2,"isOpen"]},null),(l()(),c._40(0,["",""])),(l()(),c._20(0,null,0,0,"br",[],null,null,null,null,null)),(l()(),c._40(0,[" ","\n                  "])),(l()(),c._40(null,["\n          "]))],function(l,n){l(n,1,0,n.context.$implicit.lat,n.context.$implicit.lng,n.context.$implicit.iconUrl),l(n,5,0,n.context.$implicit.lat,n.context.$implicit.lng,n.context.$implicit.info)},function(l,n){l(n,6,0,n.context.$implicit.label),l(n,8,0,n.context.$implicit.message)})}function r(l){return c._41(0,[(l()(),c._20(0,null,null,51,"div",[["class","container"]],null,null,null,null,null)),(l()(),c._40(null,["\n        "])),(l()(),c._20(0,null,null,33,"div",[],null,null,null,null,null)),(l()(),c._40(null,["\n            "])),(l()(),c._20(0,null,null,14,"select",[],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],function(l,n,e){var t=!0,o=l.component;if("change"===n){t=!1!==c._34(l,5).onChange(e.target.value)&&t}if("blur"===n){t=!1!==c._34(l,5).onTouched()&&t}if("ngModelChange"===n){t=!1!==(o.selected=e)&&t}if("ngModelChange"===n){t=!1!==o.onSelected(o.selected)&&t}return t},null,null)),c._18(16384,null,0,m.r,[c.Q,c.o],null,null),c._37(1024,null,m.i,function(l){return[l]},[m.r]),c._18(671744,null,0,m.n,[[8,null],[8,null],[8,null],[2,m.i]],{model:[0,"model"]},{update:"ngModelChange"}),c._37(2048,null,m.j,null,[m.n]),c._18(16384,null,0,m.k,[m.j],null,null),(l()(),c._40(null,["\n         "])),(l()(),c._20(0,null,null,3,"option",[["disabled",""],["hidden",""]],null,null,null,null,null)),c._18(147456,null,0,m.o,[c.o,c.Q,[2,m.r]],{value:[0,"value"]},null),c._18(147456,null,0,m.w,[c.o,c.Q,[8,null]],{value:[0,"value"]},null),(l()(),c._40(null,["Select Device Id "])),(l()(),c._40(null,["\n                "])),(l()(),c._14(16777216,null,null,1,null,u)),c._18(802816,null,0,k.i,[c._2,c.Z,c.z],{ngForOf:[0,"ngForOf"]},null),(l()(),c._40(null,["\n           "])),(l()(),c._40(null,["\n        \n            "])),(l()(),c._20(0,null,null,14,"select",[],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],function(l,n,e){var t=!0,o=l.component;if("change"===n){t=!1!==c._34(l,21).onChange(e.target.value)&&t}if("blur"===n){t=!1!==c._34(l,21).onTouched()&&t}if("ngModelChange"===n){t=!1!==(o.select=e)&&t}if("ngModelChange"===n){t=!1!==o.onSelect(o.select)&&t}return t},null,null)),c._18(16384,null,0,m.r,[c.Q,c.o],null,null),c._37(1024,null,m.i,function(l){return[l]},[m.r]),c._18(671744,null,0,m.n,[[8,null],[8,null],[8,null],[2,m.i]],{model:[0,"model"]},{update:"ngModelChange"}),c._37(2048,null,m.j,null,[m.n]),c._18(16384,null,0,m.k,[m.j],null,null),(l()(),c._40(null,["\n                "])),(l()(),c._20(0,null,null,3,"option",[["disabled",""],["hidden",""]],null,null,null,null,null)),c._18(147456,null,0,m.o,[c.o,c.Q,[2,m.r]],{value:[0,"value"]},null),c._18(147456,null,0,m.w,[c.o,c.Q,[8,null]],{value:[0,"value"]},null),(l()(),c._40(null,["Select Device Status "])),(l()(),c._40(null,["\n                "])),(l()(),c._14(16777216,null,null,1,null,a)),c._18(802816,null,0,k.i,[c._2,c.Z,c.z],{ngForOf:[0,"ngForOf"]},null),(l()(),c._40(null,["\n           "])),(l()(),c._40(null,["\n        "])),(l()(),c._40(null,["\n        "])),(l()(),c._20(0,null,null,13,"agm-map",[],[[2,"sebm-google-map-container",null]],[[null,"zoomChange"]],function(l,n,e){var t=!0,o=l.component;if("zoomChange"===n){t=!1!==o.zoomChange(e)&&t}return t},N.b,N.a)),c._37(4608,null,p.a,p.a,[x.a,c.H]),c._37(4608,null,f.a,f.a,[x.a,c.H,p.a]),c._37(4608,null,L.a,L.a,[x.a,c.H]),c._37(4608,null,S.a,S.a,[x.a,c.H]),c._37(4608,null,P.a,P.a,[x.a,c.H]),c._37(4608,null,I.a,I.a,[x.a,c.H]),c._37(4608,null,M.a,M.a,[x.a,c.H]),c._37(512,null,x.a,x.a,[z.a,c.H]),c._18(770048,null,0,U.a,[c.o,x.a],{longitude:[0,"longitude"],latitude:[1,"latitude"],zoom:[2,"zoom"],mapTypeControl:[3,"mapTypeControl"]},{zoomChange:"zoomChange"}),(l()(),c._40(0,["\n          "])),(l()(),c._14(16777216,null,0,1,null,i)),c._18(802816,null,0,k.i,[c._2,c.Z,c.z],{ngForOf:[0,"ngForOf"]},null),(l()(),c._40(0,["\n        "])),(l()(),c._40(null,["\n        "]))],function(l,n){var e=n.component;l(n,7,0,e.selected),l(n,12,0,e.selectUndefinedOptionValue),l(n,13,0,e.selectUndefinedOptionValue),l(n,17,0,e.someData),l(n,23,0,e.select),l(n,28,0,e.selectUndefinedOptionValue),l(n,29,0,e.selectUndefinedOptionValue),l(n,33,0,e.options);l(n,46,0,e.lng,e.lat,e.zoomLevel,!0),l(n,49,0,e.selectedData)},function(l,n){l(n,4,0,c._34(n,9).ngClassUntouched,c._34(n,9).ngClassTouched,c._34(n,9).ngClassPristine,c._34(n,9).ngClassDirty,c._34(n,9).ngClassValid,c._34(n,9).ngClassInvalid,c._34(n,9).ngClassPending),l(n,20,0,c._34(n,25).ngClassUntouched,c._34(n,25).ngClassTouched,c._34(n,25).ngClassPristine,c._34(n,25).ngClassDirty,c._34(n,25).ngClassValid,c._34(n,25).ngClassInvalid,c._34(n,25).ngClassPending);l(n,37,0,!0)})}function s(l){return c._41(0,[(l()(),c._20(0,null,null,1,"ng-component",[],null,null,null,r,R)),c._18(245760,null,0,y,[w.l,C.f,A.a],null,null)],function(l,n){l(n,1,0)},null)}Object.defineProperty(n,"__esModule",{value:!0});var c=e("/oeL"),g=function(){function l(){}return l}(),d=["agm-map[_ngcontent-%COMP%]{height:580px}select[_ngcontent-%COMP%]{width:180px;height:30px;border:1px solid;font-size:15px}option[_ngcontent-%COMP%]{width:200px;height:35px}"],m=e("bm2B"),_=e("57RD"),p=e("dY6p"),h=e("MVht"),f=e("KdOF"),v=[],b=c._17({encapsulation:2,styles:v,data:{}}),w=(c._15("agm-info-window",h.a,o,{latitude:"latitude",longitude:"longitude",disableAutoPan:"disableAutoPan",zIndex:"zIndex",maxWidth:"maxWidth",isOpen:"isOpen"},{infoWindowClose:"infoWindowClose"},["*"]),e("BkNc")),D=e("5ERs"),O=e("TbKO"),C=e("CPp0"),y=(e("5v8a"),function(){function l(l,n,e){this.router=l,this.http=n,this.nav=e,this.title="My first AGM project",this.lat=12.98164225,this.lng=77.59287357,this.mapID="TERRAIN",this.userId="12345",this.message="hi",this.markerOpen=!1,this.selectedVal="All",this.options=["Red","Yellow","Green","Disconnected","All"],this.someData=[{lat:51.673858,lng:7.615982,label:"Map A",draggable:!0,value:"GREEN",iconUrl:"http://maps.google.com/mapfiles/ms/icons/green.png",message:"",info:!1},{lat:51.373858,lng:7.215982,label:"Map B",draggable:!1,value:"RED",iconUrl:"http://maps.google.com/mapfiles/ms/icons/red.png",message:"",info:!1},{lat:51.723858,lng:7.895982,label:"Map C",draggable:!0,value:"YELLOW",iconUrl:"http://maps.google.com/mapfiles/ms/icons/yellow.png",message:"",info:!1}],this.currentUser=JSON.parse(localStorage.getItem("currentUser")),void 0!=Number(JSON.parse(localStorage.getItem("zoomLevel")))&&0!=Number(JSON.parse(localStorage.getItem("zoomLevel")))||localStorage.setItem("zoomLevel",JSON.stringify(10)),this.zoomLevel=Number(JSON.parse(localStorage.getItem("zoomLevel")))}return l.prototype.ngOnInit=function(){var l=this;this.userId=JSON.parse(localStorage.getItem("currentUser")),this.getDeviceAttributes(this.userId),this.interval=setInterval(function(){l.getDeviceAttributes(l.userId)},15e3)},l.prototype.ngOnDestroy=function(){clearInterval(this.interval)},l.prototype.clickedMarker=function(l,n){this.router.navigate(["./gauges/:"+l.label])},l.prototype.zoomChange=function(l){console.log("hi"),localStorage.setItem("zoomLevel",JSON.stringify(l)),this.zoomLevel=Number(JSON.parse(localStorage.getItem("zoomLevel")))},l.prototype.mouseOver=function(l,n){this.deviceName=n.label,this.message=n.message,l.open()},l.prototype.mouseOut=function(l,n){l.close()},l.prototype.onSelect=function(l){this.selectedVal=l,this.selectedData=this.someData.filter(function(n){return n.value==l||-1!=n.value.indexOf(l)}),"All"==l&&(this.selectedData=this.someData)},l.prototype.onSelected=function(l){for(var n=0;n<this.someData.length;n++)this.markerOpen=!1,this.someData[n].info=!1,this.someData[n].label==l&&(this.lat=this.someData[n].lat,this.lng=this.someData[n].lng,this.someData[n].info=!0)},l.prototype.getDeviceAttributes=function(l){var n,e=this,t=[];this.http.post("/users/deviceList",{user_id:l}).map(function(l){return l.json()}).subscribe(function(l){console.log(l);for(var o=0;o<l.length;o++){"undefined"!=l[o].http_post_interval?(n=Number(l[o].http_post_interval),n>=60?n=n:n<60&&n>=30?n*=3:n>0&&n<30&&(n*=5)):(l[o].http_post_interval=0,n=5),n*=1e3,console.log("dashboard",n),"undefined"!=l[o].ang2_threshold&&"undefined"!=l[o].ang3_threshold||(l[o].ang2_threshold="DISABLE",l[o].ang3_threshold="DISABLE",l[o].ang2_lower_limit="20000",l[o].ang3_lower_limit="0");var u={},a=new Date,i=new Date(l[o].server_log_time),r=a.getTime()-i.getTime();console.log(l),console.log(l[o].server_log_time),console.log("date2",i),console.log("today",a),console.log("diffDays",r),console.log("timedif",n),n>=6e4&&(r-=5e4),console.log("diffDays after subtract",r);var s,c,g,d=l[o].device_id,m=l[o].gas_level,_=l[o].gas_detector;e.tankLevel=Math.round(20*Number(m)),Number(_)>4?e.GasLeak=Math.round(6.25*(Number(_)-4)):e.GasLeak=0,e.powerSupply=Math.round(8.33*Number(l[o].power_level)),1==l[o].gas_leak||null!=l[o].ang2_threshold&&"ENABLE"==l[o].ang2_threshold&&null!=l[o].ang2_lower_limit&&1e3*Number(l[o].gas_detector)>Number(l[o].ang2_lower_limit)?(s="Red",g="Gas Leak",c=D.a.imagePath+"redmarker.png",r>n&&(s="Disconnected,Red",g="Gas Leak and Disconnected",c=D.a.imagePath+"redmarkerdisconnected.png")):1==l[o].low_gas||null!=l[o].ang3_threshold&&"ENABLE"==l[o].ang3_threshold&&null!=l[o].ang3_lower_limit&&1e3*Number(l[o].gas_level)<Number(l[o].ang3_lower_limit)?(s="Yellow",g="Low Gas",c=D.a.imagePath+"yellow.png",e.powerSupply<75?(s="Red",g="Low Power Level",console.log("low power hit"),c=D.a.imagePath+"redmarker.png",console.log("checking time"),console.log("last time dif",r),console.log("timediff",n),r>n&&(console.log("disconnected"),g="Low Gas,Low Power and Disconnected",s="Disconnected,Red",c=D.a.imagePath+"redmarkerdisconnected.png")):r>n&&(g="Low Gas and Disconnected",s="Disconnected,Yellow",c=D.a.imagePath+"yellowmarkerdisconnected.png",e.powerSupply<75&&(s="Disconnected,Red",g="Low Power Level",c=D.a.imagePath+"redmarkerdisconnected.png"))):(s="Green",g="All Good ",c=D.a.imagePath+"greenmarker.png",e.powerSupply<75?(s="Red",g="Low Power Level",c=D.a.imagePath+"redmarker.png",r>=n&&(s="Disconnected,Red",g="Low Power Level and Disconnected",c=D.a.imagePath+"redmarkerdisconnected.png")):e.powerSupply>=75?(s="Green",c=D.a.imagePath+"greenmarker.png",r>n&&(s="Green,Disconnected",g="Disconnected",c=D.a.imagePath+"greenmarkerdisconnected.png")):r>n&&(s="Green,Disconnected",g="Disconnected",c=D.a.imagePath+"greenmarkerdisconnected.png"));var p=l[o].coordinates,p=p.split(","),h=p[0],f=p[1];u.lat=Number(h),u.lng=Number(f),u.label=d,u.value=s,u.iconUrl=c,u.message="Status: "+g,u.info=!1,t.push(u),0==o&&(e.lat=Number(h),e.lng=Number(f))}JSON.stringify(t);e.someData=JSON.parse(JSON.stringify(t)),e.selectedData=e.someData.filter(function(l){return l.value==e.selectedVal||-1!=l.value.indexOf(e.selectedVal)}),"All"==e.selectedVal&&(e.selectedData=e.someData)},function(l){console.log("Oooops!"+l)})},l.ctorParameters=function(){return[{type:w.l},{type:C.f},{type:O.c}]},l}()),k=e("qbdv"),N=e("9U4N"),x=e("BfPg"),L=e("DCX4"),S=e("Ds4W"),P=e("9fk+"),I=e("mECe"),M=e("7PDj"),z=e("wW3n"),U=e("t+Rn"),A=e("EDb1"),$=[d],R=c._17({encapsulation:0,styles:$,data:{}}),G=c._15("ng-component",y,s,{},{},[]),E=e("niyx"),V=e("wvx+"),J=e("q+Vp");e.d(n,"DashboardModuleNgFactory",function(){return Q});var Q=c._16(g,[],function(l){return c._31([c._32(512,c.l,c._12,[[8,[G]],[3,c.l],c.F]),c._32(4608,m.v,m.v,[]),c._32(4608,k.l,k.k,[c.B]),c._32(4608,E.c,E.c,[]),c._32(4608,E.b,E.b,[]),c._32(4608,z.a,V.b,[V.a,E.c,E.b]),c._32(512,m.t,m.t,[]),c._32(512,m.e,m.e,[]),c._32(512,k.b,k.b,[]),c._32(512,w.o,w.o,[[2,w.t],[2,w.l]]),c._32(512,J.a,J.a,[]),c._32(512,g,g,[]),c._32(1024,w.j,function(){return[[{path:"",component:y}]]},[]),c._32(256,V.a,{apiKey:"AIzaSyCJ8L3mMI-DQ_3xoh6DR78Os7qtUsVuT1k"},[])])})}});